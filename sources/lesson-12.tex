\documentclass[a4paper,12pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[margin=2cm]{geometry}
\usepackage{tikz}
\usepackage{amsmath}

\input{commands.tex}

\begin{document}

    \title{Занятие 12. Функции от случайных векторов.}
    \author{Тигетов Давид}
    \maketitle


    \section{Задача 18.515}
    \section*{Условие}
    Случайные величины $X$ и $Y$ независимы и подчиняются одному и тому же индикаторному распределению $B(1,p)$. Описать законы распределения случайных величин
    $Z = X + Y$ и $V = X Y$.
    \section*{Решение}
    Величина $X$ подчиняется индикаторному распределению $B(1,p)$ означает, что $X$ принимает значение 1 с веростноятью $p$ и 0 с вероятностью $1-p$:

    \begin{tabular}{|c|c|}
        \hline
        $X$ & $P$   \\
        \hline
        0   & $1-p$ \\
        \hline
        1   & $p$   \\
        \hline
    \end{tabular}

    Составим таблицы значения для вероятностей и значений величин $Z$ и $V$:

    \begin{tabular}{|c|c|c|c|c|}
        \hline
        $X$ & $Y$ & $P$                 & $Z$ & $V$ \\
        \hline
        0   & 0   & $(1-p) \cdot (1-p)$ & 0   & 0   \\
        \hline
        1   & 0   & $p \cdot (1-p)$     & 1   & 0   \\
        \hline
        0   & 1   & $(1-p) \cdot p$     & 1   & 0   \\
        \hline
        1   & 1   & $p \cdot p$         & 2   & 1   \\
        \hline
    \end{tabular}

    Собираем различные значения величины $Z$, при одинаковых значениях суммируем вероятности:

    \begin{tabular}{|c|c|}
        \hline
        $Z$ & $P$                             \\
        \hline
        0   & $(1-p) \cdot (1-p)$             \\
        \hline
        1   & $p \cdot (1-p) + (1-p) \cdot p$ \\
        \hline
        2   & $p \cdot p$                     \\
        \hline
    \end{tabular}

    Аналогично для величины $V$:

    \begin{tabular}{|c|c|}
        \hline
        $V$ & $P$                                                 \\
        \hline
        0   & $(1-p) \cdot (1-p) + p \cdot (1-p) + (1-p) \cdot p$ \\
        \hline
        1   & $p \cdot p$                                         \\
        \hline
    \end{tabular}

    \section*{Ответ}
    Закон распределения $Z$:

    \begin{tabular}{|c|c|}
        \hline
        $Z$ & $P$         \\
        \hline
        0   & $(1-p)^2$   \\
        \hline
        1   & $2 p (1-p)$ \\
        \hline
        2   & $p^2$       \\
        \hline
    \end{tabular}

    Закон распределения величины $V$:

    \begin{tabular}{|c|c|}
        \hline
        $V$ & $P$                   \\
        \hline
        0   & $(1-p)^2 + 2 p (1-p)$ \\
        \hline
        1   & $p^2$                 \\
        \hline
    \end{tabular}


    \section{Задача 18.518}
    \section*{Условие}
    Случайный вектор $\left ( X, Y \right )$ распределен по закону, определяемому плотностью распределения вероятностей
    $$
    f_{X, Y} ( x, y )
    = \left \{
    \begin{array}{ll}
        x + y, & 0 \le x \le 1, 0 \le y \le 1 \\
        0,     & \text{в остальных случаях}
    \end{array}
    \right .
    $$
    Найти плотности распределения вероятностей функций:
    \begin{enumerate}
        \item $Z = X + Y$,
        \item $U = XY$.
    \end{enumerate}

    \section*{Решение}
    \begin{enumerate}
        \item Плотность вероятности $f_Z(z)$ величины $Z$ находим интергрированием совместной плотности $f_{X,Y}(x,y)$ с учётом условия $x+y=z$:
        \begin{equation}
            f_Z(z)
            = \int \limits_{-\infty}^{\infty} f_{X,Y}(x, z-x) dx
            = \left \{
            \begin{array}{ll}
                0,                                      & z < 0       \\
                \int \limits_0^z f_{X,Y}(x,z-x) dx,     & 0 < z \le 1 \\
                \int \limits_{z-1}^1 f_{X,Y}(x,z-x) dx, & 1 < z \le 2 \\
                0,                                      & 2 < z
            \end{array}
            \right .
        \end{equation}

        \begin{figure}[!h]
            \center
            \begin{tikzpicture}[scale=5]
                % оси
                \draw [->] ( -0.5, 0 ) -- ( 1.5, 0 ) node [below] at ( 1.5, 0 ) {$x$};
                \draw [->] ( 0, -0.5 ) -- ( 0, 1.5 ) node [left] at ( 0, 1.5 ) {$y$};

                % квадратик
                \draw [fill=gray!20] ( 0, 0 ) rectangle ( 1, 1 );
                \node [below] at ( 1, 0 ) {$1$};
                \node [left] at ( 0, 1 ) {$1$};

                % прямые
                \draw [dashed] ( -0.5, 0.3 ) -- ( 0.3, -0.5 ) node [below] at ( 0.3, -0.5 ) {$x + y = -0.2$};
                \draw [dashed] ( -0.5, 0.8 ) -- ( 0.8, -0.5 ) node [below] at ( 0.8, -0.5 ) {$x + y = 0.3$};
                \draw [dashed] ( -0.3, 1.5 ) -- ( 1.5, -0.3 ) node [below] at ( 1.5, -0.3 ) {$x + y = 1.2$};
                \draw [dashed] ( 0.6, 1.5 ) -- ( 1.5, 0.6 ) node [below] at ( 1.5, 0.6 ) {$x + y = 2.1$};

                % отрезки
                \draw [ultra thick] ( 0, 0.3 ) -- ( 0.3, 0 );
                \draw [ultra thick] ( 0.2, 1 ) -- ( 1, 0.2 );
            \end{tikzpicture}
            \caption{Вычисление $f_Z(z)$: отрезки с ненулевыми значениями плотности.}
        \end{figure}

        Интеграл для второго случая ($0 < z \le 1$):
        \begin{equation}
            \int \limits_0^z f_{X,Y}(x,z-x) dx
            = \int \limits_0^z \left ( x + z - x \right ) dx
            = \int \limits_0^z z dx
            = \left . z x \right |_0^z
            = z^2
        \end{equation}

        Интеграл для третьего случая ($1 < z \le 2$):
        \begin{equation}
            \int \limits_{z-1}^1 f_{X,Y}(x,z-x) dx
            = \int \limits_{z-1}^1 \left ( x + z - x \right ) dx
            = \int \limits_{z-1}^1 z dx
            = \left . z x \right |_{z-1}^1
            = z - z (z - 1)
            = 2 z - z^2
        \end{equation}

        Таким образом,
        \begin{equation}
            f_Z(z)
            = \left \{
            \begin{array}{ll}
                0,        & z < 0       \\
                z^2,      & 0 < z \le 1 \\
                2z - z^2, & 1 < z \le 2 \\
                0,        & 2 < z
            \end{array}
            \right .
        \end{equation}

        \item Для величины $U$ сперва найдем функцию распределения:
        \begin{equation}
            F_U(u)
            = \probability{XY < u}
            = \left \{
            \begin{array}{ll}
                0,                                          & u < 0         \\
                \iint \limits_{xy < u} f_{X,Y}(x, y) dy dx, & 0 \le u \le 1 \\
                1,                                          & 1 < u
            \end{array}
            \right .
        \end{equation}

        Вычислим интеграл для второго случая ($0 \le u \le 1$):
        \begin{multline}
            \iint \limits_{xy < u} f_{X,Y}(x, y) dy dx
            = \int \limits_0^u \int \limits_0^1 ( x + y ) dy dx + \int \limits_u^1 \int \limits_0^{\frac{u}{x}} ( x + y ) dy dx = \\
            %
            = \int \limits_0^u \left . \left ( x y + \frac{y^2}{2} \right ) \right |_0^1 dx + \int \limits_u^1 \left . \left ( x y + \frac{y^2}{2} \right ) \right |_0^{\frac{u}{x}} dx = \\
            = \int \limits_0^u \left ( x + \frac{1}{2} \right ) dx + \int \limits_u^1 \left ( x \frac{u}{x} + \frac{u^2}{2x^2} \right ) dx = \\
            = \left . \left ( \frac{x^2}{2} + \frac{1}{2} x \right ) \right |_0^u + \left . \left ( u x + \frac{u^2}{2} \left ( - \frac{1}{x} \right ) \right ) \right |_u^1 dx = \\
            %
            = \frac{u^2}{2} + \frac{1}{2} u + u - \frac{u^2}{2} - u^2 - \frac{u^2}{2} \left ( - \frac{1}{u} \right )
            = \frac{1}{2} u + u - u^2 + \frac{u}{2}
            = 2 u - u^2
        \end{multline}

        \begin{figure}[!h]
            \center
            \begin{tikzpicture}[scale=5]
                % оси
                \draw [->] ( -0.1, 0 ) -- ( 1.1, 0 ) node [below] at ( 1.1, 0 ) {$x$};
                \draw [->] ( 0, -0.1 ) -- ( 0, 1.1 ) node [left] at ( 0, 1.1 ) {$y$};

                % квадратик
                \draw [fill=gray!20] ( 0, 0 ) rectangle ( 1, 1 );
                \node [below] at ( 1, 0 ) {$1$};
                \node [left] at ( 0, 1 ) {$1$};

                % гипербола
                \draw [ultra thick, domain=0.2:1] plot (\x, {0.2/\x});

                % пунктир
                \draw [dashed] ( 0.2, 0 ) -- ( 0.2, 1 ) node [below] at ( 0.2, 0 ) {$u$};

                % площади
                \node at ( 0.1, 0.5 ) {$1$};
                \node at ( 0.6, 0.2 ) {$2$};
            \end{tikzpicture}
            \caption{Вычисление $F_U(u)$: 1 - область первого интеграла, 2 - область второго интеграла.}
        \end{figure}

        Таким образом, функция распределения имеет вид:
        \begin{equation}
            F_U(u)
            = \left \{
            \begin{array}{ll}
                0,         & u < 0         \\
                2 u - u^2, & 0 \le u \le 1 \\
                1,         & 1 < u
            \end{array}
            \right .
        \end{equation}

        Откуда плотность вероятности $f_U(u)$ величины $U$:
        \begin{equation}
            f_U(u)
            = \derivative{u} F_U(u)
            = \left \{
            \begin{array}{ll}
                0,      & u < 0         \\
                2 - 2u, & 0 \le u \le 1 \\
                1,      & 1 < u
            \end{array}
            \right .
        \end{equation}

%        \item Плотность вероятности $f_U(u)$ величины $U$ найдем аналогичным образом:
%        \begin{equation}
%            f_U(u)
%            = \int \limits_{-\infty}^{\infty} f_{X,Y} \left ( x, \frac{u}{x} \right ) dx
%            = \left \{
%            \begin{array}{ll}
%                0,                                                              & u \le 0     \\
%                \int \limits_{u}^{1} f_{X,Y} \left ( x, \frac{u}{x} \right ) dx & 0 < u \le 1 \\
%                0,                                                              & 1 < u
%            \end{array}
%            \right .
%        \end{equation}
%
%        Интеграл во втором случае ($0 \le u \le 1$):
%        \begin{multline}
%            \int \limits_{u}^{1} f_{X,Y} \left ( x, \frac{u}{x} \right ) dx
%            = \int \limits_{u}^{1} \left ( x + \frac{u}{x} \right ) dx
%            = \left . \left ( \frac{x^2}{2} + u \ln x \right ) \right |_u^1 = \\
%            %
%            = \frac{1}{2} + u \ln 1 - \frac{u^2}{2} - u \ln u
%            = \frac{1}{2} - \frac{u^2}{2} - u \ln u
%        \end{multline}
    \end{enumerate}

    \section*{Ответ}
    \begin{enumerate}
        \item Плотность вероятности величины $Z$:
        $$
        f_Z(z)
        = \left \{
        \begin{array}{ll}
            0,        & z < 0       \\
            z^2,      & 0 < z \le 1 \\
            2z - z^2, & 1 < z \le 2 \\
            0,        & 2 < z
        \end{array}
        \right .
        .
        $$

        \item Плотность вероятности величины $U$:
        $$
        f_U(u)
        = \derivative{u} F_U(u)
        = \left \{
        \begin{array}{ll}
            0,      & u < 0         \\
            2 - 2u, & 0 \le u \le 1 \\
            1,      & 1 < u
        \end{array}
        \right .
        .
        $$
    \end{enumerate}


    \section{Задача 18.521}
    \section*{Условие}
    Случайные величины $X$ и $Y$ независимы и одинаково распределены по закону $\mathcal{N}(0, \sigma^2)$. Установить, по какому закону распределена случайная величина
    $R = \sqrt{X^2 + Y^2}$.
    \section*{Решение}
    Пусть $F_R(r)$ --- функция распределения величины $R$:
    \begin{multline}
        F_R(r)
        = \probability{R < r}
        = \probability{\sqrt{X^2 + Y^2} < r}
        = \probability{X^2 + Y^2 < r^2} = \\
        %
        = \left \{
        \begin{array}{ll}
            0,                                                   & r \le 0 \\
            \iint \limits_{x^2 + y^2 < r^2} f_{X,Y}(x, y) dy dx, & 0 < r   \\
        \end{array}
        \right .
    \end{multline}
    где $f_{X,Y}(x, y)$ --- совместная плотность вероятности вектора $\left ( X, Y \right )$, равная произведению плотности вероятности $f_X(x)$ величины $X$ и
    плотности вероятности $f_Y(y)$ величины $Y$ поскольку величины $X$ и $Y$ \textbf{независимы}:
    \begin{equation}
        f_{X,Y}(x, y) = f_X(x) \cdot f_Y(y),
    \end{equation}
    Одномерные плотности имеют одинаковый вид:
    \begin{gather}
        f_X(x) = \frac{1}{\sqrt{2 \pi} \sigma} e^{- \frac{x^2}{2 \sigma^2}} , \\
        f_Y(y) = \frac{1}{\sqrt{2 \pi} \sigma} e^{- \frac{y^2}{2 \sigma^2}} .
    \end{gather}

    Вычислим итеграл в функции распределения (случай $0 < r$):
    \begin{equation}
        \iint \limits_{x^2 + y^2 < r^2} f_{X,Y}(x, y) dy dx
        = \iint \limits_{x^2 + y^2 < r^2} \frac{1}{\sqrt{2 \pi} \sigma} e^{- \frac{x^2}{2 \sigma^2}} \cdot \frac{1}{\sqrt{2 \pi} \sigma} e^{- \frac{y^2}{2 \sigma^2}} dy dx
        = \iint \limits_{x^2 + y^2 < r^2} \frac{1}{2 \pi \sigma^2} e^{- \frac{x^2 + y^2}{2 \sigma^2}} dy dx
    \end{equation}
    Для вычисления итеграла перейдем к полярным координатам
    \begin{gather}
        x = \rho \cos \varphi , \\
        y = \rho \sin \varphi .
    \end{gather}
    Якобиан преобразования:
    \begin{equation}
        J
        = \begin{vmatrix}
              \cos \varphi & - \rho \sin \varphi \\
              \sin \varphi & \rho \cos \varphi   \\
        \end{vmatrix}
        = \rho \cos^2 \varphi + \rho \sin^2 \varphi = \rho
        .
    \end{equation}

    В результате замены интеграл принимает вид
    \begin{multline}
        \iint \limits_{x^2 + y^2 < r^2} f_{X,Y}(x, y) dy dx
        = \iint \limits_{\rho^2 < r^2, 0 \le \varphi \le 2 \pi} \frac{1}{2 \pi \sigma^2} e^{- \frac{\rho^2}{2 \sigma^2}} \rho d \varphi d \rho
        = \int \limits_0^{r} \int \limits_0^{2 \pi} \frac{1}{2 \pi \sigma^2} e^{- \frac{\rho^2}{2 \sigma^2}} \rho d \varphi d \rho = \\
        %
        = \int \limits_0^{r} 2 \pi \frac{1}{2 \pi \sigma^2} e^{- \frac{\rho^2}{2 \sigma^2}} \rho d \rho
        = \int \limits_0^{r} \frac{\rho}{\sigma^2} e^{- \frac{\rho^2}{2 \sigma^2}} d \rho
        = \left . \left ( - e^{- \frac{\rho^2}{2 \sigma^2}} \right ) \right |_0^{r}
        = 1 - e^{-\frac{r^2}{2 \sigma^2}}
    \end{multline}

    Таким образом, функция распределения величины $R$:
    \begin{equation}
        F_R(r)
        = \left \{
        \begin{array}{ll}
            0,                               & r \le 0 \\
            1 - e^{-\frac{r^2}{2 \sigma^2}}, & 0 < r   \\
        \end{array}
        \right .
    \end{equation}
    и плотность вероятности величины $R$:
    \begin{equation}
        f_R(r)
        = \derivative{r} F_R(r)
        = \left \{
        \begin{array}{ll}
            0,                                                                       & r \le 0 \\
            - e^{-\frac{r^2}{2 \sigma^2}} \left ( - \frac{2 r}{2 \sigma^2} \right ), & 0 < r   \\
        \end{array}
        \right .
        = \left \{
        \begin{array}{ll}
            0,                                              & r \le 0 \\
            \frac{r}{\sigma^2} e^{-\frac{r^2}{2 \sigma^2}}, & 0 < r   \\
        \end{array}
        \right .
    \end{equation}
    \section*{Ответ}
    Закон распределения Релея. Функция плотности вероятности $f(r)$:
    $$
    f(r)
    = \left \{
    \begin{array}{ll}
        0,                                              & r \le 0 \\
        \frac{r}{\sigma^2} e^{-\frac{r^2}{2 \sigma^2}}, & 0 < r   \\
    \end{array}
    \right .
    $$


    \section{Домашнее задание}

    Задачи 514, 517, 518.
\end{document}